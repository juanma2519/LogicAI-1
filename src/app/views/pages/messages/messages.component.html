<c-card class="p-4 shadow-lg mb-4">
  <div class="d-flex justify-content-between align-items-center mb-3">
    <h3 class="m-0">Mensajes</h3>

    <!-- Toolbar superior -->
    <div class="d-flex gap-2">
      <button cButton color="secondary" variant="outline" (click)="cargarMensajes(userId || '')">
        <svg cIcon [cIcon]="icons.cilReload"></svg>
      </button>
      <button cButton color="success" (click)="marcarTodosComoLeidos()">
        <i cIcon name="check2-all" class="me-1"></i> Marcar todos como leídos
      </button>
    </div>
  </div>

  <ul cListGroup style="list-style: none;">
    <!-- Recibir mensajes desde Node.js -->
    <ng-container *ngFor="let mensaje of mensajes">
      <li cListGroupItem class="shadow p-3 mb-2 bg-body rounded">
        <div class="d-flex justify-content-between align-items-start">
          <div>
            <h5 class="mb-1">
              <c-icon name="envelope" class="me-2"></c-icon>
              {{ mensaje.titulo }}
            </h5>
            <p class="mb-2">{{ mensaje.contenido }}</p>
            <div class="d-flex align-items-center gap-3 small text-muted">
              <span>
                Recepción: {{ mensaje.fecha_envio | date: 'dd/MM/yyyy HH:mm' }}
              </span>
              <span
                class="badge"
                [ngClass]="mensaje.leido ? 'bg-success' : 'bg-warning text-dark'">
                {{ mensaje.leido ? 'Leído' : 'Sin leer' }}
              </span>
            </div>
          </div>

          <!-- Acciones por mensaje -->
          <div class="d-flex flex-wrap gap-2">
            <button cButton color="primary" (click)="verDetalles(mensaje)">
              <svg cIcon name="cilCommentSquare"></svg>
            </button>

            <button
              cButton
              color="success"
              [disabled]="mensaje.leido"
              (click)="marcarComoLeido(mensaje)">
              <svg cIcon [name]="mensaje.leido ? 'cilEnvelopeOpen' : 'cilEnvelopeClosed'"></svg>
            </button>

            <button
              cButton
              color="danger"
              variant="outline"
              (click)="eliminar(mensaje)">
              <svg cIcon name="cilTrash"></svg>
            </button>
          </div>
        </div>
      </li>
    </ng-container>
  </ul>
</c-card>